# On-Your-Own-Housing-Database-Management-System

CREATE TABLE Users
(
User_ID NUMBER GENERATED BY DEFAULT AS IDENTITY 
(
START WITH 1
INCREMENT BY 1 
MINVALUE 1
MAXVALUE 5000),
User_F_Name VARCHAR(100) NOT NULL, 
User_L_Name VARCHAR(100) NOT NULL,
User_Type VARCHAR(108) NOT NULL CHECK (User Type IN (Tenant', 'Landlord', 'Broker')), 
User_Contact Number(10) NOT NULL, 
User_Email VARCHAR(50), 
User_SSN Number (15) NOT NULL, 
Brokerage Number (15), 
CONSTRAINT User_PK PRIMARY KEY (User_ID), 
CONSTRAINT User_UK UNIQUE (User_Contact, User_Email, User_SSN) 
);


CREATE TABLE Admin
(
Admin_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 10), 
Admin_F_Name VARCHAR(50) NOT NULL,
Admin_L_Name VARCHAR(50) NOT NULL, 
Admin_Contact NUMBER(10) NOT NULL,
Admin_Address VARCHAR(158) NOT NULL,
Admin_Email VARCHAR(50), 
CONSTRAINT Admin_PK PRIMARY KEY(Admin_ID),
CONSTRAINT Admin_CONTACT UNIQUE (Admin_Contact, Admin_Email)
);


CREATE TABLE Neighbourhood
(
Neighbourhood_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 2000),
Nearest_Hospital Varchar(50), 
Nearest_PoliceStation Varchar(50),
Nearest_Grocery Varchar(50), 
Nearest_Pharmacy Varchar(50),
Nearest_Airport Varchar(50),
Nearest_RailwayStation Varchar(50),
CONSTRAINT Neighbourhood_PK PRIMARY KEY (Neighbourhood_ID) 
);


CREATE TABLE Lease_Type
(
Lease¬_Type_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 2000),
LT_Lease Type Term VARCHAR(10) CHECK (LT_Lease_Type_ Term IN (‘Short’, ‘Long’)) NOT NULL, CONSTRAINT Lease_Type_PK PRIMARY KEY(Lease_Type_ID)
);


CREATE TABLE Property
(
Property_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1 
MINVALUE 1 
MAXVALUE 2000), 
User_ID NUMBER NOT NULL, 
Neighbourhood_ID NUMBER NOT NULL, 
Admin_ID NUMBER NOT NULL, 
Lease_Type_ID NUMBER NOT NULL, 
Property_Name VARCHAR(50), 
Property_Available_From DATE NOT NULL, 
Property_Status VARCHAR(58) NOT NULL,
Property_Verified VARCHAR(18) NOT NULL CHECK (Property_Verified-IN( 'Y', 'N')), 
CONSTRAINT Property_PK PRIMARY KEY (Property_ID), 
CONSTRAINT Property_FK FOREIGN KEY (User ID) REFERENCES Users (User_ID), 
CONSTRAINT Property_FK1 FOREIGN KEY (Neighbourhood_ID) REFERENCES Neighbourhood (Neighbourhood_ID),
CONSTRAINT Property_FK2 FOREIGN KEY (Admin_ID) REFERENCES Admin (Admin_ID), 
CONSTRAINT Property FK3 FOREIGN KEY (Lease_Type_ID) REFERENCES Lease_Type(Lease_Type_ID)
);


CREATE TABLE Property_Feature
(
Property_Feature_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 3000),
Property_ID NUMBER NOT NULL,
PF_Gym VARCHAR (10) CHECK (PF GYM IN (Y', 'N')), 
PF_Pool VARCHAR(18) CHECK (PF Pool IN (Y', 'N')), 
PF_Pets_Allowed VARCHAR(10) CHECK (PF_Pets Allowed IN ('Y', 'N')),
PF_Badminton_Court VARCHAR(10) CHECK (PF_Badminton_Court IN ('Y', 'N')), 
PF_Tennis_Court VARCHAR(10) CHECK (PF_Tennis_Court IN (Y', 'N')),
PF_Gaming_Zone VARCHAR(10) CHECK (PF_Gaming_Zone IN ('Y', 'N')), 
PF_Soccer_Court VARCHAR(10) CHECK (PF_Soccer_Court IN ('Y', 'N)), 
PF_Washer_Dryer VARCHAR(10) CHECK (PF_Washer_Dryer IN ('Y', 'N),
PF_WD_CoinOperated VARCHAR(10) CHECK (PF_WD_CoinOperated IN ('Y', 'N')), 
PF_SemiFurnished VARCHAR(10) CHECK (PF_Semi_Furnished IN (Y', 'N')), 
PF_Unfurnished VARCHAR(10) CHECK (PF_Unfurnished IN ('Y', 'N')), 
CONSTRAINT Property_Feature_PK PRIMARY KEY(Property_Feature_ID), 
CONSTRAINT Property_Feature_FK FOREIGN KEY (Property_ID) REFERENCES Property (Property_ID)
);


CREATE TABLE Showings
(
Showing_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1 
MAXVALUE 3000), 
Property_ID NUMBER NOT NULL, 
Showing_Date Date NOT NULL, 
Showing_Time Timestamp NOT NULL, 
Showing_Enable VARCHAR(18) CHECK (Showing Enable IN (Y', 'N')), 
CONSTRAINT Showings_PK PRIMARY KEY(Showing_ID), 
CONSTRAINT Showings_FK FOREIGN KEY (Property_ID) REFERENCES Property (Property_ID)
);


CREATE TABLE Payment
( 
Payment_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
( 
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 5000), 
Property_ID NUMBER NOT NULL,
User_ID NUMBER NOT NULL,
Payment_Type VARCHAR (20) NOT NULL CHECK (Payment Type IN ('ACH', 'Credit Card')), 
CONSTRAINT Payment_PK PRIMARY KEY(Payment_ID), 
CONSTRAINT Payment_Property_FK FOREIGN KEY (Property_ID) REFERENCES Property (Property_ID), CONSTRAINT Payment_User_FK FOREIGN KEY (User_ID) REFERENCES Users (User_ID)
);


CREATE TABLE Promo_Code
(
Promo_Code_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 1000), 
Payment_ID NUMBER NOT NULL,
Promo_Code_Type VARCHAR(50) NOT NULL,
Promo_Discount NUMBER (38) NOT NULL,
CONSTRAINT Promo_Code_PK PRIMARY KEY(Promo_Code_ID), 
CONSTRAINT Promo_Code_FK FOREIGN KEY (Payment_ID) REFERENCES Payment (Payment_ID)
);


CREATE TABLE Address
Address_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
( 
START WITH 1
INCREMENT BY 1 
MINVALUE 1
MAXVALUE 3000),
Property_ID NUMBER NOT NULL,
House_Number VARCHAR(50) NOT NULL,
Street VARCHAR(50) NOT NULL, 
PinCode NUMBER(38) NOT NULL,
City VARCHAR(50) NOT NULL,
State VARCHAR(50) NOT NULL,
Region VARCHAR(50),
CONSTRAINT Address_PK PRIMARY KEY(Address_ID), 
CONSTRAINT Address_FK FOREIGN KEY(Property_ID) REFERENCES Property (Property_ID)
);


CREATE TABLE Property_Type
(
Property_Type_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 5000),
Property_ID NUMBER NOT NULL,
NoofBedrooms NUMBER NOT NULL,
NoOfBathrooms NUMBER NOT NULL, 
NoOfFloors NUMBER NOT NULL,
CONSTRAINT Property_Type_PK PRIMARY KEY(Property_Type_ID),
CONSTRAINT Property_Type_FK FOREIGN KEY (Property_ID) REFERENCES Property (Property_ID));


CREATE TABLE Rent
(
Rent_ID NUMBER GENERATED BY DEFAULT AS IDENTITY
(
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 5000),
Property ID NUMBER NOT NULL,
Rent_Start_Date DATE NOT NULL, 
Rent_End_Date DATE NOT NULL, 
Rent_Amount NUMBER NOT NULL, 
CONSTRAINT Rent_PK PRIMARY KEY(Rent_ID), 
CONSTRAINT Rent_FK FOREIGN KEY (Property_ID) REFERENCES Property (Property_ID));


Queries: 

Query 1: Extracts the second lowest rent for the properties available

Select min(Rent Amount)
From (Select Distinct Rent_Amount from Rent order by Rent_Amount desc) 
Where rownum<=2;



Query 2: Extracts promo code types, rent start and end dates, rent amounts for all the payments that have been made under discount of greater than 20%

SELECT PROMO_CODE.PROMO_CODE_TYPE, payment.payment_type, rent.rent_start_date, trunc(rent.RENT_END_DATE, 'DAY') as WeekOfRentEndDay, 
--calculate rent after applying promo discount 
rent.rent_amount promo_discount/100 as discounted_rent,
rent.rent_amount
from promo_code
left join payment on promo_code.payment_id=payment.payment_id
left join rent on payment.property_id=rent.property_id
where promo_code.promo_discount>20 and rent.rent_start_date >SYSDATE+15



Query 3: Address details of the property with 'tops' as nearest grocery in the neighborhood and its availability

SELECT INITCAP (Property. Property Name) AS PropertyName, 
NVL (Property.Property_Status, 'Rented') AS Status, 
Property. Property_Available_from AS "AVAILABLE FROM", 
Address.House_Number AS "HOUSE NUMBER", 
Address.Street AS Street
FROM Property
JOIN Address ON Property.Property_ID=Address.Property_ID
WHERE Property. Property Name= (SELECT Property. Property Name
FROM Neighbourhood
JOIN Property ON Neighbourhood. Neighbourhood ID-Property.Neighbourhood_ID WHERE Neighbourhood. Nearest Grocery="Tops')




Query 4: Find listed user, user type and listed property with highest showings

WITH highestShowingProperty AS
(select property.property_name, count(*), property.property_id 
from property 
join showings on property.property_id = showings.property_id 
group by property.property_name, property.property_id 
order by 2 desc
fetch first 1 row only)
select UPPER (CONCAT(CONCAT(users.user_f_name, ', '), users.user_1_name)) as Full Name,
users.user_type, property.property_name
from users 
join property on users.user_id = property.user_id
where property.property_id in (select property id from highest ShowingProperty);





Query 5: Selected details of property where rent is between 1000 and 4500

Select INITCAP (pt.property_name) as PROPERTYNAME, UPPER(pt.property_status) as PROPERTYSTATUS, ptype.noofbedrooms, 
--casing because data is for unfurnished 
CASE pf.pf unfurnished
when 'N' then 'Furnished Place'
else 'Not Furnished Place'
end as FURNISHED,
count(*) as AvaliableListings
from property pt left outer join property type ptype on
pt.property_id=ptype.property_id left outer join property feature of on 
ptype.property_id=pf.property_id left outer join rent r on
pf.property_id=r.property_id
--condition for rent range
where r.rent_amount between 1000 and 4500
group by pt.property_name, pt.property_status, ptype.noofbedrooms, 
pf.pf_unfurnished having count(*) >=1 
--order by number of bedrooms 
order by ptype.noofbedrooms;




Query 6: Checking the property details for the next 4 showings for broker

Select 
property.property_name as PROPERTY, 
showings.showing_date as SHOWINGDATE, 
showings.showing time as SHOWINGTIME, 
property.property_verified as TRUSTED, 
lease_type.lt_lease_type_term as LeaseType,
CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(CONCAT(addr.house_number,, ), addr.street
'), addr.city),', '), addr.state) as FullAddress
from property join showings on
property.property_id=showings.property_id join users on
property.user_id=users.user_id join lease_type on
property.lease_type_id= lease_type.lease_type_id join address addr on property.property_id=addr.property_id
where showings.showing_enable='Y'
and showings.showing_date>sysdate and users.user_type like 'Bro%' order by showings.showing_date asc fetch first 4 rows only;











